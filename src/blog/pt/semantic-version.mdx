---
title: 'Versionamento sem√¢ntico (SemVer)'
publishedAt: '2024-06-13'
description: 'Explicando o tal do semantic versioning, tamb√©m conhecido como SemVer.'
cover: 'cover.png'
altCover: 'Imagem com n√∫meros repesentando o versionamento sem√¢ntico'
tags:
  - semantic version
  - semver
  - versionamento
category: Versionamento
---

Muito provavelmente, voc√™ j√° precisou instalar uma biblioteca para utilizar em
seu projeto e, ao fazer isso, deve ter percebido que ela vem com um
n√∫mero de vers√£o. Esse n√∫mero pode aparecer no nome do arquivo que
voc√™ est√° referenciando no `src` da tag `script` ou dentro de um arquivo
`package.json`, por exemplo. Esse n√∫mero nos ajuda em diversas coisas: a achar a
documenta√ß√£o correta para a vers√£o que estamos utilizando, a saber se estamos na
mais atual, etc. Mas o mais importante √© que ele nos ajuda a entender o que
mudou entre uma vers√£o e outra. E √© a√≠ que o _semantic versioning_ entra.

## O que √© o versionamento sem√¢ntico?

O versionamento sem√¢ntico (_semantic versioning_ em ingl√™s),
ou **[SemVer](https://semver.org/)**, √© uma conven√ß√£o de versionamento
utilizada para definir como as vers√µes de um software devem ser incrementadas.

Essa conven√ß√£o √© baseada em tr√™s n√∫meros, separados por pontos, que
representam, respectivamente, a vers√£o **major** <small>(1.)</small>,
**minor** <small>(2.)</small> e **patch** <small>(3)</small>. Exemplo: `1.2.3`.

### Patch

O n√∫mero do patch √© incrementado quando corre√ß√µes de bugs s√£o feitas na
biblioteca. Ou seja, quando a mudan√ßa n√£o adiciona novas funcionalidades e n√£o
quebra a compatibilidade com a vers√£o anterior; o que funcionava antes
continua funcionando.

**Exemplo:**

Quando a vers√£o do React DOM foi atualizada de `17.0.0` para `17.0.1`:

> **17.0.1 (October 22, 2020)** <br />
> React DOM <br />
> Fix a crash in IE11. ([@gaearon](https://github.com/gaearon) in [#20071](https://github.com/facebook/react/pull/20071))<br />
> _<small>trecho do changelog do react</small>_

Podemos ver, atrav√©s de um [trecho do changelog do React](https://github.com/facebook/react/blob/20b6f4c0e8a1f40ee61735201645e0395ff08f94/CHANGELOG.md#1701-october-22-2020)
, que a vers√£o `17.0.1` foi lan√ßada para corrigir um bug que estava causando um
crash no Internet Explorer 11 (<abbr title="v√° com Deus">RIP</abbr>).

### Minor

O n√∫mero _minor_ √© incrementado quando **novas funcionalidades** s√£o adicionadas
√† biblioteca. Essas novas funcionalidades n√£o devem afetar o funcionamento do
que j√° existia, ou seja, n√£o devem quebrar a compatibilidade com a vers√£o
anterior.

**Durante a publica√ß√£o dessa nova vers√£o, o n√∫mero do _patch_ √© resetado para
`0`.**

Um ponto importante √© que, durante a publica√ß√£o de uma nova vers√£o _minor_,
tamb√©m √© poss√≠vel que corre√ß√µes de bugs sejam inclu√≠das. Mas mesmo que isso
aconte√ßa, devemos manter o _reset_ do _patch_ para o n√∫mero `0`.

**Exemplo:**

Podemos pegar outra biblioteca como exemplo, o `Jest`. Quando a vers√£o foi
atualizada de `29.6.4` para `29.7.0`, vemos que novas funcionalidades
adicionadas, mas tamb√©m houve corre√ß√µes de bugs.

> #### **29.7.0**
> ##### Features
> `[create-jest]` Add `npm init` / `yarn create` initialiser for Jest projects ([#14453](https://github.com/jestjs/jest/pull/14453))<br />
> `[jest-validate]` Allow deprecation warnings for unknown options ([#14499](https://github.com/jestjs/jest/pull/14499))<br />
> ##### Fixes
> `[jest-resolver]` Replace unmatched capture groups in `moduleNameMapper` with empty string instead of `undefined` ([#14507](https://github.com/jestjs/jest/pull/14507))<br />
> `[jest-snapshot]` Allow for strings as well as template literals in inline snapshots ([#14465](https://github.com/jestjs/jest/pull/14465))<br />
> `[@jest/test-sequencer]` Calculate test runtime if `perStats.duration` is missing [(#14473](https://github.com/jestjs/jest/pull/14473))<br />
> _<small>trecho do changelog do jest</small>_

N√£o vamos nos apegar ao o que mudou, mas podemos ver que a vers√£o `29.7.0` foi
lan√ßada com novas funcionalidades e tamb√©m com bug fixes, ela
avan√ßou de `29.6.4` para `29.7.0`. Se somente as corre√ß√µes de bugs fossem
inclu√≠das, a vers√£o seria `29.6.5`, pois somente o _patch_ deveria ser
incrementado.

### Major

O n√∫mero _major_ √© incrementado quando **mudan√ßas que quebram a compatibilidade**
com a vers√£o anterior s√£o feitas. Ou seja, quando mudan√ßas que afetam a forma
como a biblioteca √© utilizada s√£o realizadas e, com isso o desenvolvedor que
utiliza a biblioteca precisa fazer altera√ß√µes em seu c√≥digo para que ele
continue funcionando. Essas mudan√ßas s√£o conhecidas como _**breaking-changes**_.

Resumindo, mudan√ßas que quebram a compatibilidade com a vers√£o anterior
s√£o mudan√ßas que fazem com que o **c√≥digo que funcionava antes n√£o funcione mais
com a nova vers√£o**.

Quando isso acontece o mantenedor da biblioteca deve incrementar o n√∫mero
_major_ e resetar os n√∫meros _minor_ e _patch_ para `0`.

Assim como na _minor_, √© poss√≠vel que novas funcionalidades e corre√ß√µes de bugs
sejam inclu√≠das em uma nova vers√£o _major_, mas mesmo que isso aconte√ßa, devemos
manter o _reset_ dos n√∫meros _minor_ e _patch_ para `0`.

#### Guia de migra√ß√£o

√â bem comum que os desenvolvedores das bibliotecas forne√ßam um guia de migra√ß√£o
para ajudar os usu√°rios a migrarem de uma vers√£o para outra. Bibliotecas como
o React, Next.js e Jest, por exemplo, possuem guias de migra√ß√£o bem detalhados:

- [Guia de migra√ß√£o do Next.js 13](https://nextjs.org/docs/pages/building-your-application/upgrading/version-13)
- [Guia de migra√ß√£o para o React 18](https://react.dev/blog/2022/03/08/react-18-upgrade-guide)

### Changelogs

Al√©m do guia de migra√ß√£o, tamb√©m existe um tal de "_**changelog**_", que √© um
documento que lista todas as mudan√ßas feitas em uma biblioteca/aplica√ß√£o, desde
a primeira vers√£o at√© a atual.

- [Changelog do React](https://github.com/facebook/react/blob/main/CHANGELOG.md)
- [Changelog do Jest](https://github.com/jestjs/jest/blob/main/CHANGELOG.md#2970)

Com esse arquivo, conseguimos atualizar a vers√£o da biblioteca mesmo que ela n√£o
forne√ßa um guia de migra√ß√£o, pois, se bem escrito, ele deve conter todas as
mudan√ßas e, principalmente, todas as _breaking-changes_ que ocorreram.

Tamb√©m podemos encontrar esse tipo de informa√ß√£o dentro das _releases_ no
reposit√≥rio da biblioteca, como, por exemplo, no [reposit√≥rio do React](https://github.com/facebook/react/releases)

## Exemplo na pr√°tica:

Aqui teremos uma simula√ß√£o de biblioteca que prov√©m fun√ß√µes matem√°ticas b√°sicas
e que segue o **SemVer**.

<CodeEditor
  closableTabs={false}
  activeFile="/lib/1.0.0.js"
  visibleFiles={['/lib/1.0.0.js', '/lib/1.0.1.js', '/lib/1.1.0.js', '/lib/2.0.0.js', '/CHANGELOG.md']}
  customSetup={{ 
    dependencies: { 
      "react-markdown": "latest" 
    }
  }}
  files={{
    '/App.js': `import { useEffect, useState } from 'react';
import ReactMarkdown from 'react-markdown';
import changelog from './CHANGELOG.md';

export default function App() {
  const [markdown, setMarkdown] = useState("");

  useEffect(() => {
    fetch(changelog)
      .then((res) => res.text())
      .then((text) => setMarkdown(text));
  }, []);

  const css = \`
    body {
      margin: 0;
      padding: 16px;
    }
    code {
      background-color: #f4f4f4;
      padding: 4px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    li {
      line-height: 1.5;
    }
  \`;

  return (
    <div>
    <style>{css}</style>
      <ReactMarkdown>
        {markdown}
      </ReactMarkdown>
    </div>
  )
}
`,
    '/lib/1.0.0.js': `export function sum(a, b) {
  return a + b;
}

// temos um bug aqui, a subtra√ß√£o est√° somando
export function subtract(a, b) {
  return a + b;
}`,
    '/lib/1.0.1.js': `export function sum(a, b) {
  return a + b;
}

// bug corrigido
export function subtract(a, b) {
  return a - b;
}`,
    '/lib/1.1.0.js': `export function sum(a, b) {
  return a + b;
}

export function subtract(a, b) {
  return a - b;
}

// nova funcionalidade sem impactar as anteriores
export function multiply(a, b) {
  return a * b;
}`,
    '/lib/2.0.0.js': `export function sum({a, b}) {
  return a + b;
}

export function subtract({a, b}) {
  return a - b;
}

export function multiply({a, b}) {
  return a * b;
}`,
    '/CHANGELOG.md': `# Changelog

## 2.0.0

### Breaking changes:

- Refatora fun√ß√µes \`sum\`, \`subtract\` e \`multiply\` para receberem um √∫nico argumento,
um objeto com propriedades a e b ao inv√©s de dois argumentos

## 1.1.0

### Features:
- Adiciona fun√ß√£o de \`multiply\`

## 1.0.1

### Fixes:
- Corrige bug na fun√ß√£o \`subtract\`

## 1.0.0

### Features: 
- Adiciona fun√ß√µes de \`sum\` e \`subtract\``
  }}
/>

No exemplo acima, temos uma simula√ß√£o de _lib_ onde, a cada nova vers√£o, o n√∫mero
de vers√£o √© incrementado seguindo o _semantic versioning_.

Al√©m disso, temos um arquivo `CHANGELOG.md` que lista todas as mudan√ßas feitas
em cada vers√£o, desde a primeira at√© a √∫ltima.

## Vers√µes 0.y.z

Uma biblioteca com vers√£o `0.3.0`, por exemplo, indica que ela ainda est√° em fase
de desenvolvimento, isso significa que ela pode ter _breaking changes_ a
qualquer momento, e essas _breaking changes_ n√£o ir√£o incrementar o n√∫mero
_major_.

O desenvolvedor da biblioteca deve seguir o _SemVer_ a partir da vers√£o `1.0.0`.
A vers√£o `1.0.0` deve ser lan√ßada quando a biblioteca estiver pronta para ser
utilizada em produ√ß√£o e sua _API_ (m√©todos/fun√ß√µes/classes que ela disponibiliza
) estiver est√°vel.

Um grande exemplo disso √© o _React Native_, que est√° por a√≠ h√° anos e ainda
continua em uma vers√£o de desenvolvimento. Quem j√° precisou atualizar a vers√£o
do _React Native_ sabe o trabalho que isso pode causar com tantas _breaking
changes_ poss√≠veis üôÅ

- [Changelog do React Native](github.com/facebook/react-native/blob/main/changelog.md#breaking)

Portanto, **tenha cuidado a atualizar as depend√™ncias do seu projeto que est√£o
em vers√µes de desenvolvimento** (0.y.z), pois podem ocorrer inconsist√™ncias.
Sempre leia o changelog e procure por guias de migra√ß√£o na documenta√ß√£o da
biblioteca.

### Ponto importante:

> Caso voc√™ venha a desenvolver uma biblioteca, tome cuidado ao utilizar ferramentas como
o _semantic-release_, _lerna_, para gerenciar o release da primeira vers√£o
`1.0.0`. Caso sua biblioteca esteja em alguma vers√£o `0.x.y`, essas ferramentas
**podem n√£o modificar** a vers√£o para a primeira _major_ `1.0.0`, mesmo que voc√™
informe a elas que ocorreram _breaking changes_, pois elas seguem o
_semantic version_ e n√£o ir√£o incrementar o _major_ enquanto a vers√£o for
`0.x.y`.

## Prereleases

Al√©m das vers√µes `0.y.z`, tamb√©m temos as _prereleases_, que s√£o vers√µes
lan√ßadas antes da vers√£o final proposta, para testes e feedbacks da comunidade.

Essas vers√µes s√£o identificadas por um sufixo, como `1.0.0-alpha.1`,
`1.0.0-beta.1`, `1.0.0-rc.1`, etc. Quando os testes s√£o finalizados e a vers√£o
estiver pronta para ser lan√ßada, a vers√£o final ser√° lan√ßada sem o sufixo.

Podemos ver que o _Next.js_ utiliza bastante as vers√µes _prereleases_ para
testar novas funcionalidades antes de lan√ßar a vers√£o final.

- [Releases do Next.js](https://github.com/vercel/next.js/releases)

Tais sufixos n√£o seguem nenhuma regra espec√≠fica, ficando a cargo do mantenedor
da biblioteca decidir como ir√° nomear essas vers√µes. Por√©m √© comum vermos
`alpha`, `beta`, `next`, `rc` e `canary` sendo utilizados.

Elas n√£o s√£o instaladas por padr√£o ao utilizar o comando `npm install`, sendo
necess√°rio informar o sufixo para instalar uma vers√£o _prerelease_.

**Exemplo:**

```bash
npm install minha-lib@1.0.0-alpha.1
```

E para terminar, vale mencionar que o _SemVer_ √© uma conven√ß√£o e n√£o uma regra.
Portanto, √© poss√≠vel que algumas bibliotecas n√£o sigam essa conven√ß√£o, mas √©
importante que o desenvolvedor da biblioteca informe isso em sua documenta√ß√£o.

Por fim, quem criou o _SemVer_ foi [Tom Preston-Werner](https://tom.preston-werner.com/)
e sua documenta√ß√£o pode ser encontrada em [semver.org](https://semver.org/)
